/* main.css v10 â€” Iterative Evaluation: Performance & UX Refinement */
:root{
  --bg: #071023;
  --panel: #0d1627;
  --fg: #eaf0f6;
  --muted: #9aa6b2;
  --accent: #d43f3a;
  --accent-2: #b54b8a;
  --glass-bg: rgba(20, 30, 48, 0.4);
  --glass-border: rgba(255, 255, 255, 0.05);
  --radius: 12px;
  --font-sans: 'Inter', system-ui, -apple-system, sans-serif;
  scroll-padding-top: 40px;
}

/* ... (Basis-Stile, Start-Overlay, Progress etc. bleiben gleich) ... */
*, *::before, *::after { box-sizing: border-box; }

html { scroll-behavior: smooth; }
body {
  margin: 0;
  background: linear-gradient(180deg, var(--bg) 0%, #030814 100%);
  color: var(--fg);
  font-family: var(--font-sans);
  font-size: 16px;
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
a { color: var(--accent); text-decoration: none; }
h1, h2, h3, h4, strong { font-weight: 700; color: white; }

/* Accessibility */
.skip-link { position: absolute; top: -40px; left: 0; background: var(--accent); color: white; padding: 8px; z-index: 10000; }
.skip-link:focus { top: 0; }
body:not(.show-focus) :focus { outline: none; }
body.show-focus :focus { outline: 2px solid var(--accent); outline-offset: 2px; }

/* Start Overlay */
#start-overlay {
  position: fixed; inset: 0; z-index: 10000;
  display: flex; align-items: center; justify-content: center;
  background: rgba(7, 16, 35, 0.8);
  backdrop-filter: blur(10px);
  transition: opacity 0.5s ease-out;
}
.start-box { text-align: center; padding: 20px; }
.start-box .btn-cta { background-color: var(--accent); color: white; padding: 12px 24px; border-radius: 8px; border: none; font-size: 1rem; cursor: pointer; }

/* Reading progress */
#read-progress {
  position: fixed; top: 0; left: 0; height: 4px;
  background: linear-gradient(90deg, var(--accent), var(--accent-2));
  width: 0; z-index: 1200;
  transition: width 0.15s linear;
}

.container { max-width: 1100px; margin: 0 auto; padding: 0 24px; }

/* Hero */
.hero {
  position: relative; padding: 120px 0 80px; text-align: center; overflow: hidden;
}
.hero-bg {
  position: absolute; inset: -20%;
  background: radial-gradient(circle at 15% 25%, rgba(212,63,58,0.12), transparent 40%),
              radial-gradient(circle at 85% 75%, rgba(181,75,138,0.08), transparent 40%);
  filter: blur(40px);
  will-change: transform;
}
.title { font-size: clamp(2.5rem, 6vw, 3.5rem); line-height: 1.1; margin: 0 0 16px; font-weight: 800; }
.lead { color: var(--muted); max-width: 680px; margin: 0 auto; font-size: 1.125rem; }


/* Layout & Sidebar */
.layout { display: grid; grid-template-columns: 280px 1fr; gap: 32px; align-items: start; margin-top: 40px; }
.sidebar { position: sticky; top: 40px; }
.toc {
  background: var(--glass-bg); backdrop-filter: blur(8px);
  padding: 20px; border-radius: var(--radius); border: 1px solid var(--glass-border);
}
.toc ul { list-style: none; padding: 0; margin: 0; }
.toc a {
  display: block; padding: 10px 12px; border-radius: 8px; color: var(--muted);
  font-size: 0.95rem; transition: all 0.2s ease;
}
.toc a:hover { background: rgba(255, 255, 255, 0.04); color: var(--fg); }
.toc a.active {
  color: var(--accent); font-weight: 700;
  background: rgba(212, 63, 58, 0.1); transform: translateX(5px);
}

/* NEU: Chapter Card */
.chapter-card {
  position: absolute;
  top: 0;
  left: 100%; /* Positioniert rechts neben dem TOC */
  margin-left: 16px; /* Abstand zum TOC */
  width: 240px;
  padding: 16px;
  border-radius: var(--radius);
  background: #111c30;
  border: 1px solid var(--glass-border);
  box-shadow: 0 10px 30px rgba(0,0,0,0.4);
  
  /* Animations-Setup */
  opacity: 0;
  transform: translateX(10px) scale(0.98);
  transition: opacity 0.25s ease-out, transform 0.25s ease-out;
  pointer-events: none; /* Wichtig, damit sie nicht im Weg ist */
  z-index: 100;
}
.chapter-card.visible {
  opacity: 1;
  transform: translateX(0) scale(1);
}
.chapter-card strong { display: block; color: var(--accent); margin-bottom: 4px; }
.chapter-card p { font-size: 0.9rem; color: var(--muted); margin: 0; }

/* Panels */
/* ... (panel, section Stile bleiben gleich) ... */
.panel {
  background: var(--glass-bg);
  backdrop-filter: blur(8px);
  padding: 28px; border-radius: var(--radius); margin-bottom: 24px;
  border: 1px solid var(--glass-border);
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
  transition: transform 0.3s ease-out, box-shadow 0.3s ease-out, border-color 0.3s ease-out;
}
/* WICHTIG: Die Sektions-Animation wird jetzt durch JS-Klassen gesteuert, nicht mehr durch GSAP direkt */
.section {
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.7s ease-out, transform 0.7s ease-out;
  will-change: transform, opacity;
}
.section.is-visible {
  opacity: 1;
  transform: translateY(0);
}

.panel.playing {
  border-color: rgba(212, 63, 58, 0.2);
  box-shadow: 0 20px 60px rgba(212, 63, 58, 0.1);
  transform: scale(1.01);
}
.panel h2 {
  font-size: 1.5rem; margin: 0 0 16px; display: flex;
  align-items: center; justify-content: space-between; gap: 12px;
}
.copy-anchor {
  font-size: 1rem; padding: 4px; border-radius: 6px; border: none;
  background: transparent; color: var(--muted); cursor: pointer;
  transition: color 0.2s, background-color 0.2s;
}
.copy-anchor:hover { background-color: var(--glass-border); color: var(--fg); }
audio { width: 100%; border-radius: 8px; margin-top: 16px; }

/* ... (Cinematic Scene, Audio Dock, Footer, Responsive etc. bleiben gleich) ... */
.cinematic-scene {
  position: relative; min-height: 100vh;
  display: flex; align-items: center; justify-content: center;
  overflow: hidden; text-align: center;
  --scene-accent: rgba(212, 63, 58, 0); /* Animatable CSS Variable */
}
.scene-bg {
  position: absolute; inset: 0;
  background: radial-gradient(circle at center, var(--scene-accent), transparent 70%);
}
.scene-title { font-size: 2.5rem; opacity: 0; transform: translateY(20px); }
.scene-sub { font-size: 1.125rem; color: var(--muted); opacity: 0; transform: translateY(10px); }
.scene-keywords {
  display: flex; gap: 16px; flex-wrap: wrap; justify-content: center;
  margin-top: 24px; font-size: 1.5rem; font-weight: 700;
}
.scene-keywords span { opacity: 0; transform: scale(0.5); color: var(--accent); }

/* Audio Dock */
.audio-dock {
  position: fixed; left: 20px; right: 20px; bottom: 20px;
  background: var(--glass-bg);
  backdrop-filter: blur(10px);
  padding: 12px 16px; border-radius: var(--radius);
  display: flex; align-items: center; gap: 16px;
  box-shadow: 0 10px 50px rgba(0,0,0,0.5); z-index: 1000;
  transform: translateY(calc(100% + 20px));
  transition: transform 0.4s cubic-bezier(0.22, 1, 0.36, 1);
}
.audio-dock.visible { transform: translateY(0); }
#dock-title { font-weight: 700; font-size: 0.9rem; }
#dock-state { font-size: 0.75rem; color: var(--muted); }
.dock-visual { flex: 1; min-width: 0; }
#wave-canvas { width: 100%; height: 50px; }
.dock-controls { display: flex; align-items: center; gap: 8px; }
.icon-btn {
  background: transparent; border: 0; color: var(--muted); cursor: pointer;
  font-size: 20px; padding: 8px; border-radius: 50%;
  width: 40px; height: 40px; display: grid; place-items: center;
  transition: background-color 0.2s, color 0.2s;
}
.icon-btn:hover { background-color: var(--glass-border); color: var(--fg); }
.download-link-small { font-size: 0.8rem; color: var(--muted); padding: 8px 12px; border-radius: 8px; border: 1px solid var(--glass-border); }

.page-footer { padding: 40px 0; text-align: center; color: var(--muted); font-size: 0.9rem; }

@media (max-width: 900px) {
  .layout { grid-template-columns: 1fr; }
  .sidebar { position: static; top: 0; }
  .chapter-card { display: none; }
  .audio-dock { flex-wrap: wrap; justify-content: center; padding: 12px; }
  .dock-visual { order: -1; width: 100%; flex-basis: 100%; }
}
